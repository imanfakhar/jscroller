/// <reference path="jquery-1.7.1.min.js" />

/**
 * jScroller Plugin 0.0.9
 *
 * Copyright (c) 2012  Renato Saito (renato.saito at live.com)
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */

(function () {
    jQuery.fn.jScroller = function (i, j) {
        function f(e) {
            0 === a.find("#jscroll-loading").length && (a.find(".jscroll-loadmore").parent("div").remove(), a.append('<button id="jscroll-loading" disabled="disabled">' + b.loadingButtonText + "</button>")); jQuery.ajax({
                url: i, type: "POST", data: { start: d, limit: b.limit }, timeout: b.timeout, success: function (c) {
                    a.find("#jscroll-loading").remove(); if (c.Success === false) b.onErrorCallback(a, c.Message); else {
                        g = c.total; d = d + b.limit; for (var h = 0; h < c.data.length; h++) b.onSuccessCallback(c.data[h],
a); d >= g || c.data.length === 0 ? a.append('<div id="jscroll-fulllist">' + b.fullListText + "</div>") : e === false && a.append('<div><button class="jscroll-loadmore">' + b.loadMoreButtonText + "</button></div>")
                    }
                }, error: function (c, d, e) { if (e == "timeout") b.onTimeoutCallback(); else b.onErrorCallback(a, e) }
            })
        } function k() { a.on("click", ".jscroll-loadmore", function () { f(!1); jQuery(this).parent("div").remove() }) } var b = jQuery.extend({
            limit: 10, onSuccessCallback: function () { }, onErrorCallback: function () { alert("An error occurred while trying to retrive data from store") },
            onTimeoutCallback: function () { }, timeout: 3E3, loadingButtonText: "Loading...", loadMoreButtonText: "Load more", fullListText: "There is no more items to show"
        }, j), a = jQuery(this), d = 0, g = 0; jQuery(window).scroll(function () { var a = jQuery(this); a.scrollTop() === jQuery(document).height() - a.height() && !(d >= g) && f(!0); return !1 }); jQuery(document).ready(function () { k(); f(!1) })
    }
})(jQuery);